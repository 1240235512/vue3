"use strict";(self["webpackChunkvue3_element_plus_admin"]=self["webpackChunkvue3_element_plus_admin"]||[]).push([[8164],{78362:function(e,t,r){r.d(t,{D4:function(){return a},Iw:function(){return d},K4:function(){return o},Lo:function(){return b},PI:function(){return p},Sx:function(){return h},Uj:function(){return m},X$:function(){return g},b2:function(){return f},c3:function(){return c},ef:function(){return i},mg:function(){return s},ou:function(){return l},wS:function(){return u}});var n=r(20077);function a(e){return(0,n.Z)({url:"/backstage/role/page",method:"get",params:e})}function o(e){return(0,n.Z)({url:`/backstage/role/info/${e}`,method:"get"})}function l(e){return(0,n.Z)({url:"/backstage/role/create",method:"post",data:e})}function u(e){return(0,n.Z)({url:"/backstage/role/update",method:"post",data:e})}function i(e){return(0,n.Z)({url:"/backstage/role/delete",method:"post",data:e})}function s(e){return(0,n.Z)({url:"/backstage/role/show",method:"post",data:e})}function d(){return(0,n.Z)({url:"/backstage/role/select/list",method:"get"})}function m(e){return(0,n.Z)({url:"/backstage/role/global/page",method:"get",params:e})}function c(e){return(0,n.Z)({url:`/backstage/role/global/info/${e}`,method:"get"})}function f(e){return(0,n.Z)({url:"/backstage/role/global/create",method:"post",data:e})}function p(e){return(0,n.Z)({url:"/backstage/role/global/update",method:"post",data:e})}function g(e){return(0,n.Z)({url:"/backstage/role/global/delete",method:"post",data:e})}function b(e){return(0,n.Z)({url:"/backstage/role/global/show",method:"post",data:e})}function h(e){return(0,n.Z)({url:`/backstage/role/global/select/list/${e}`,method:"get"})}},70392:function(e,t,r){r.r(t),r.d(t,{default:function(){return Z}});var n=r(42321),a=(r(1926),r(14646)),o=(r(21123),r(13289)),l=(r(14635),r(59571)),u=(r(97085),r(33612)),i=(r(82262),r(58125),r(66847)),s=(r(28630),r(440)),d=r(54592);const m={class:"dialog-footer"},c=(0,s.Uk)("取消"),f=(0,s.Uk)("确认");function p(e,t,r,p,g,b){const h=i.EZ,w=l.nH,_=u.m,k=l.ly,v=o.mi,Z=a.d0,y=n.t,V=(0,s.Q2)("repeat");return(0,s.wg)(),(0,s.j4)(Z,{width:"450px",title:e.form.id?"编辑":"新增",modelValue:e.visible,"onUpdate:modelValue":t[6]||(t[6]=t=>e.visible=t),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle,"append-to-body":"",draggable:""},{footer:(0,s.w5)((()=>[(0,s._)("span",m,[(0,s.Wm)(v,{onClick:t[4]||(t[4]=t=>e.visible=!1)},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.wy)(((0,s.wg)(),(0,s.j4)(v,{type:"primary",onClick:t[5]||(t[5]=t=>e.submit())},{default:(0,s.w5)((()=>[f])),_:1})),[[V]])])])),default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(k,{model:e.form,rules:e.rules,ref:"refForm",onKeyup:t[3]||(t[3]=(0,d.D2)((t=>e.submit()),["enter"])),"label-position":"top"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{label:"角色名称",prop:"name"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.form.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.name=t),placeholder:"角色名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(w,{label:"备注",prop:"remark"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.form.remark,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.remark=t),type:"textarea",placeholder:"备注",maxlength:"100","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(w,{label:"权限",prop:"enterprise_menu_ids"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{class:"width-full",ref:"refCascader",modelValue:e.form.enterprise_menu_ids,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.enterprise_menu_ids=t),options:e.menus,props:e.cascaderProps,"show-all-levels":!1,"collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options","props"])])),_:1})])),_:1},8,["model","rules"])),[[y,e.loading]])])),_:1},8,["title","modelValue","onClosed"])}var g=r(84367),b=r(68257),h=r(58712),w=r(78362),_=(0,s.aZ)({emits:["refresh"],setup(e,{emit:t}){const r=(0,g.iH)(),n=(0,g.iH)(),a=(0,g.qj)({loading:!1,visible:!1,form:{id:null,name:"",remark:"",enterprise_menu_ids:[]},menus:[]}),o=(0,g.qj)(function(){return{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],enterprise_menu_ids:[{type:"array",required:!0,message:"请选择权限",trigger:"blur"}]}}()),l=(0,s.Fl)((()=>{const e={multiple:!0,emitPath:!1,checkStrictly:!1,value:"id",label:"name_cn",children:"children"};return e})),u=async()=>{const e=await(0,h.Iw)();if(e){const t=[{id:0,name_cn:"一级菜单",name_en:"First level menu",parent_id:0,children:e.data}];a.menus=t}},i=async e=>{if(a.visible=!0,a.loading=!0,a.form.id=e,await u(),e){const t=await(0,w.K4)(e);t&&(a.form.name=t.data.name,a.form.remark=t.data.remark,a.form.enterprise_menu_ids=t.data.enterprise_menu_ids)}(0,s.Y3)((()=>{a.loading=!1}))},d=()=>{r.value.validate((async e=>{if(e){const e=n.value.getCheckedNodes(!0),r=[];e.forEach((e=>{r.push.apply(r,e.pathValues)})),a.form.enterprise_menu_ids=Array.from(new Set(r)).filter((e=>0!==e));const o=a.form.id?await(0,w.wS)(a.form):await(0,w.ou)(a.form);o&&(a.visible=!1,(0,b.z8)({message:"操作成功!",type:"success"}),t("refresh"))}}))},m=()=>{r.value.resetFields()};return{refForm:r,refCascader:n,...(0,g.BK)(a),rules:o,cascaderProps:l,init:i,submit:d,dialogClosedHandle:m}}}),k=r(40465);const v=(0,k.Z)(_,[["render",p]]);var Z=v},15691:function(e,t,r){r.d(t,{Z:function(){return p}});var n=r(33392),a=r(7163),o=r(85963),l=r(54421),u=a.Z?a.Z.isConcatSpreadable:void 0;function i(e){return(0,l.Z)(e)||(0,o.Z)(e)||!!(u&&e&&e[u])}var s=i;function d(e,t,r,a,o){var l=-1,u=e.length;r||(r=s),o||(o=[]);while(++l<u){var i=e[l];t>0&&r(i)?t>1?d(i,t-1,r,a,o):(0,n.Z)(o,i):a||(o[o.length]=i)}return o}var m=d,c=1/0;function f(e){var t=null==e?0:e.length;return t?m(e,c):[]}var p=f}}]);