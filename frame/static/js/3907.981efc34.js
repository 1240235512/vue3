"use strict";(self["webpackChunkvue3_element_plus_admin"]=self["webpackChunkvue3_element_plus_admin"]||[]).push([[3907],{97212:function(e,r,o){o.d(r,{D4:function(){return l},EZ:function(){return n},ZJ:function(){return u},aq:function(){return i}});var t=o(20077),a=o(45764);function l(e){return(0,t.Z)({url:"/backstage/file/page",method:"get",params:e})}function n(e){return(0,t.Z)({url:"/backstage/file/delete",method:"post",data:e})}function u(e){return(0,t.Z)({url:"/backstage/file/update/config",method:"post",data:e})}function i(e){let r="";const o={url:"/backstage/file/upload",method:"get",params:e};return r=`${(0,a.bR)()+o.url}${o.params?(0,a.xA)(o.params):""}`,r}},78362:function(e,r,o){o.d(r,{D4:function(){return a},Iw:function(){return m},K4:function(){return l},Lo:function(){return b},PI:function(){return p},Sx:function(){return w},Uj:function(){return s},X$:function(){return g},b2:function(){return c},c3:function(){return f},ef:function(){return i},mg:function(){return d},ou:function(){return n},wS:function(){return u}});var t=o(20077);function a(e){return(0,t.Z)({url:"/backstage/role/page",method:"get",params:e})}function l(e){return(0,t.Z)({url:`/backstage/role/info/${e}`,method:"get"})}function n(e){return(0,t.Z)({url:"/backstage/role/create",method:"post",data:e})}function u(e){return(0,t.Z)({url:"/backstage/role/update",method:"post",data:e})}function i(e){return(0,t.Z)({url:"/backstage/role/delete",method:"post",data:e})}function d(e){return(0,t.Z)({url:"/backstage/role/show",method:"post",data:e})}function m(){return(0,t.Z)({url:"/backstage/role/select/list",method:"get"})}function s(e){return(0,t.Z)({url:"/backstage/role/global/page",method:"get",params:e})}function f(e){return(0,t.Z)({url:`/backstage/role/global/info/${e}`,method:"get"})}function c(e){return(0,t.Z)({url:"/backstage/role/global/create",method:"post",data:e})}function p(e){return(0,t.Z)({url:"/backstage/role/global/update",method:"post",data:e})}function g(e){return(0,t.Z)({url:"/backstage/role/global/delete",method:"post",data:e})}function b(e){return(0,t.Z)({url:"/backstage/role/global/show",method:"post",data:e})}function w(e){return(0,t.Z)({url:`/backstage/role/global/select/list/${e}`,method:"get"})}},25430:function(e,r,o){o.d(r,{Z:function(){return l}});var t=o(440),a=o(53945);function l(e,r){const o=(0,t.FN)().proxy;return(0,t.Fl)({get(){return e[r||a.Pl]},set(e){const t=r?`update:${r}`:a.f_;o.$emit(t,e)}})}},37530:function(e,r,o){function t(e){const r=/^-?[1-9]\d*$/;return r.test(e)}function a(e){const r=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/;return r.test(e)}function l(e){const r=/^1[0-9]{10}$/;return r.test(e)}function n(e){const r=/^[a-zA-Z0-9_-]{4,16}$/;return r.test(e)}function u(e){const r=/^[a-zA-Z0-9_-]{8,16}$/;return r.test(e)}o.d(r,{Jh:function(){return a},L6:function(){return u},U:function(){return t},iH:function(){return n},tq:function(){return l}})},87342:function(e,r,o){o.r(r),o.d(r,{default:function(){return z}});var t=o(42321),a=(o(1926),o(14646)),l=(o(21123),o(13289)),n=(o(14635),o(59571)),u=(o(97085),o(45899)),i=o(88667),d=o(64638),m=(o(20739),o(95037),o(43138)),s=(o(74123),o(37471),o(58125),o(66847)),f=(o(28630),o(440)),c=o(54592),p=o(38643);const g=(0,f.Uk)("否"),b=(0,f.Uk)("是"),w=(0,f.Uk)("女"),_=(0,f.Uk)("男"),h=(0,f.Uk)("未知"),k={class:"dialog-footer"},v=(0,f.Uk)("取消"),V=(0,f.Uk)("确认");function Z(e,r,o,Z,W,U){const y=s.EZ,x=n.nH,$=m.rh,q=m.KD,C=d.Xb,E=d.z5,z=i.Z,P=u.Z,F=n.ly,H=l.mi,j=a.d0,A=t.t,D=(0,f.Q2)("repeat");return(0,f.wg)(),(0,f.j4)(j,{width:"450px",title:e.form.id?"编辑":"新增",modelValue:e.visible,"onUpdate:modelValue":r[13]||(r[13]=r=>e.visible=r),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle,"append-to-body":"",draggable:"","destroy-on-close":""},{footer:(0,f.w5)((()=>[(0,f._)("span",k,[(0,f.Wm)(H,{onClick:r[11]||(r[11]=r=>e.visible=!1)},{default:(0,f.w5)((()=>[v])),_:1}),(0,f.wy)(((0,f.wg)(),(0,f.j4)(H,{type:"primary",onClick:r[12]||(r[12]=r=>e.submit())},{default:(0,f.w5)((()=>[V])),_:1})),[[D]])])])),default:(0,f.w5)((()=>[(0,f.wy)(((0,f.wg)(),(0,f.j4)(F,{model:e.form,rules:e.rules,ref:"refForm",onKeyup:r[10]||(r[10]=(0,c.D2)((r=>e.submit()),["enter"])),"label-position":"top"},{default:(0,f.w5)((()=>[(0,f.Wm)(x,{label:"昵称",prop:"nickname"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.nickname,"onUpdate:modelValue":r[0]||(r[0]=r=>e.form.nickname=r),placeholder:"昵称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"用户名",prop:"username"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.username,"onUpdate:modelValue":r[1]||(r[1]=r=>e.form.username=r),placeholder:"用户名",maxlength:"20","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"密码",prop:"password"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.password,"onUpdate:modelValue":r[2]||(r[2]=r=>e.form.password=r),type:"password",placeholder:"密码",maxlength:"20"},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"确认密码",prop:"confirmPassword"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.confirmPassword,"onUpdate:modelValue":r[3]||(r[3]=r=>e.form.confirmPassword=r),placeholder:"确认密码","show-password":""},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"是否是超管",prop:"supervisor"},{default:(0,f.w5)((()=>[(0,f.Wm)(q,{modelValue:e.form.supervisor,"onUpdate:modelValue":r[4]||(r[4]=r=>e.form.supervisor=r)},{default:(0,f.w5)((()=>[(0,f.Wm)($,{label:0},{default:(0,f.w5)((()=>[g])),_:1}),(0,f.Wm)($,{label:1},{default:(0,f.w5)((()=>[b])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,f.wy)((0,f.Wm)(x,{label:"角色",prop:"role_ids"},{default:(0,f.w5)((()=>[(0,f.Wm)(E,{modelValue:e.form.role_ids,"onUpdate:modelValue":r[5]||(r[5]=r=>e.form.role_ids=r)},{default:(0,f.w5)((()=>[((0,f.wg)(!0),(0,f.iD)(f.HY,null,(0,f.Ko)(e.roles,(e=>((0,f.wg)(),(0,f.j4)(C,{key:e.id,label:e.id},{default:(0,f.w5)((()=>[(0,f.Uk)((0,p.zw)(e.name),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1},512),[[c.F8,1!==e.form.supervisor]]),(0,f.Wm)(P,{"inactive-text":"展开（非必填项）"},{default:(0,f.w5)((()=>[(0,f.Wm)(x,{label:"头像",prop:"avatar"},{default:(0,f.w5)((()=>[(0,f.Wm)(z,{modelValue:e.form.avatar,"onUpdate:modelValue":r[6]||(r[6]=r=>e.form.avatar=r)},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"手机号",prop:"mobile"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.mobile,"onUpdate:modelValue":r[7]||(r[7]=r=>e.form.mobile=r),placeholder:"手机号"},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"邮箱",prop:"email"},{default:(0,f.w5)((()=>[(0,f.Wm)(y,{modelValue:e.form.email,"onUpdate:modelValue":r[8]||(r[8]=r=>e.form.email=r),placeholder:"邮箱"},null,8,["modelValue"])])),_:1}),(0,f.Wm)(x,{label:"性别",prop:"sex"},{default:(0,f.w5)((()=>[(0,f.Wm)(q,{modelValue:e.form.sex,"onUpdate:modelValue":r[9]||(r[9]=r=>e.form.sex=r)},{default:(0,f.w5)((()=>[(0,f.Wm)($,{label:0},{default:(0,f.w5)((()=>[w])),_:1}),(0,f.Wm)($,{label:1},{default:(0,f.w5)((()=>[_])),_:1}),(0,f.Wm)($,{label:2},{default:(0,f.w5)((()=>[h])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model","rules"])),[[A,e.loading]])])),_:1},8,["title","modelValue","onClosed"])}o(21703);var W=o(84367),U=o(68257),y=o(37530),x=o(78362),$=o(66420),q=(0,f.aZ)({emits:["refresh"],components:{Collapse:u.Z,ImageUploadSingle:i.Z},setup(e,{emit:r}){const o=(0,W.iH)(),t=(0,W.qj)({loading:!1,visible:!1,form:{id:null,nickname:"",username:"",password:"",confirmPassword:"",avatar:"",mobile:"",email:"",sex:2,role_ids:[],enterprise_id:"",supervisor:0},roles:[]}),a=(0,f.Fl)((()=>{const e=(e,r,o)=>{(0,y.iH)(r)?o():o(new Error("用户名由4-16位的数字、字母、中横线、下划线组成"))},r=(e,r,o)=>{t.form.id&&!(0,y.L6)(r)?o(new Error("用户名由8-16位的数字、字母、中横线、下划线组成")):t.form.id||(0,y.L6)(r)?o():o(new Error("用户名由8-16位的数字、字母、中横线、下划线组成"))},o=(e,r,o)=>{t.form.password&&t.form.password!==r?o(new Error("新密码与确认密码不一致")):o()},a=(e,r,o)=>{""===t.form.mobile||(0,y.tq)(r)?o():o(new Error("请输入正确的手机号"))},l=(e,r,o)=>{""===t.form.email||(0,y.Jh)(r)?o():o(new Error("请输入正确的邮箱"))},n=(e,r,o)=>{1!==t.form.supervisor&&0===t.form.role_ids.length?o(new Error("请选择角色")):o()};return{nickname:[{required:!0,message:"请输入昵称",trigger:"blur"}],username:[{required:!0,message:"请输入帐号",trigger:"blur"},{validator:e,trigger:"blur"}],password:[{required:!t.form.id,message:"请输入密码",trigger:"blur"},{validator:r,trigger:"blur"}],confirmPassword:[{required:!t.form.id,message:"请输入确认密码",trigger:"blur"},{validator:o,trigger:"blur"}],mobile:[{validator:a,trigger:"blur"}],email:[{validator:l,trigger:"blur"}],role_ids:[{type:"array",required:!t.form.supervisor,message:"请选择角色",trigger:"blur"},{validator:n,trigger:"blur"}]}})),l=async()=>{const e=await(0,x.Sx)(t.form.enterprise_id);e&&(t.roles=e.data)},n=async(e,r)=>{if(t.visible=!0,t.loading=!0,t.form.enterprise_id=e,t.form.id=r,await l(),r){const e=await(0,$.c3)(r);e&&(t.form.nickname=e.data.nickname,t.form.username=e.data.username,t.form.password=e.data.password,t.form.avatar=e.data.avatar,t.form.mobile=e.data.mobile,t.form.email=e.data.email,t.form.sex=e.data.sex,t.form.role_ids=e.data.roles.map((e=>e.id)),t.form.supervisor=e.data.supervisor)}(0,f.Y3)((()=>{t.loading=!1}))},u=()=>{o.value.validate((async e=>{if(e){const e=t.form.id?await(0,$.PI)(t.form):await(0,$.b2)(t.form);e&&(t.visible=!1,(0,U.z8)({message:"操作成功!",type:"success"}),r("refresh"))}}))},i=()=>{o.value.resetFields()};return{refForm:o,...(0,W.BK)(t),rules:a,init:n,submit:u,dialogClosedHandle:i}}}),C=o(40465);const E=(0,C.Z)(q,[["render",Z]]);var z=E}}]);