"use strict";(self["webpackChunkvue3_element_plus_admin"]=self["webpackChunkvue3_element_plus_admin"]||[]).push([[5430],{97212:function(e,t,l){l.d(t,{D4:function(){return u},EZ:function(){return r},ZJ:function(){return o},aq:function(){return i}});var n=l(20077),a=l(45764);function u(e){return(0,n.Z)({url:"/backstage/file/page",method:"get",params:e})}function r(e){return(0,n.Z)({url:"/backstage/file/delete",method:"post",data:e})}function o(e){return(0,n.Z)({url:"/backstage/file/update/config",method:"post",data:e})}function i(e){let t="";const l={url:"/backstage/file/upload",method:"get",params:e};return t=`${(0,a.bR)()+l.url}${l.params?(0,a.xA)(l.params):""}`,t}},91450:function(e,t,l){l.d(t,{D4:function(){return a},EZ:function(){return r},ZJ:function(){return o},ou:function(){return u}});var n=l(20077);function a(e){return(0,n.Z)({url:"/backstage/mail/page",method:"get",params:e})}function u(e){return(0,n.Z)({url:"/backstage/mail/create",method:"post",data:e})}function r(e){return(0,n.Z)({url:"/backstage/mail/delete",method:"post",data:e})}function o(e){return(0,n.Z)({url:"/backstage/mail/update/config",method:"post",data:e})}},37530:function(e,t,l){function n(e){const t=/^-?[1-9]\d*$/;return t.test(e)}function a(e){const t=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/;return t.test(e)}function u(e){const t=/^1[0-9]{10}$/;return t.test(e)}function r(e){const t=/^[a-zA-Z0-9_-]{4,16}$/;return t.test(e)}function o(e){const t=/^[a-zA-Z0-9_-]{8,16}$/;return t.test(e)}l.d(t,{Jh:function(){return a},L6:function(){return o},U:function(){return n},iH:function(){return r},tq:function(){return u}})},12423:function(e,t,l){l.r(t),l.d(t,{default:function(){return C}});var n=l(14646),a=(l(21123),l(59571)),u=(l(97085),l(13289)),r=(l(14635),l(96648)),o=l(12516),i=(l(86724),l(43138)),s=(l(74123),l(37471),l(94775)),m=(l(58125),l(66847)),d=(l(28630),l(440)),f=l(38643),c=l(54592);const p=(0,d.Uk)("私发"),b=(0,d.Uk)("群发"),g={class:"dialog-footer"},w=(0,d.Uk)("取消"),k=(0,d.Uk)("确认");function V(e,t,l,V,_,h){const y=m.EZ,v=a.nH,Z=s.Z,j=i.rh,H=i.KD,C=o.Ks,U=r["default"],W=u.mi,q=a.ly,z=n.d0,$=(0,d.Q2)("repeat");return(0,d.wg)(),(0,d.j4)(z,{width:"800px",title:e.form.id?"编辑":"新增",modelValue:e.visible,"onUpdate:modelValue":t[7]||(t[7]=t=>e.visible=t),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle,"append-to-body":"",draggable:""},{footer:(0,d.w5)((()=>[(0,d._)("span",g,[(0,d.Wm)(W,{onClick:t[5]||(t[5]=t=>e.visible=!1)},{default:(0,d.w5)((()=>[w])),_:1}),(0,d.wy)(((0,d.wg)(),(0,d.j4)(W,{type:"primary",onClick:t[6]||(t[6]=t=>e.submit())},{default:(0,d.w5)((()=>[k])),_:1})),[[$]])])])),default:(0,d.w5)((()=>[(0,d.Wm)(q,{model:e.form,rules:e.rules,ref:"refForm","label-position":"top"},{default:(0,d.w5)((()=>[(0,d.Wm)(v,{label:"邮件标题",prop:"subject"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{modelValue:e.form.subject,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.subject=t),placeholder:"邮件标题",maxlength:"50","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,d.Wm)(v,{label:"邮件内容",prop:"content"},{default:(0,d.w5)((()=>[(0,d.Wm)(Z,{ref:"refQuill",modelValue:e.form.content,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.content=t),placeholder:"输入邮件内容..."},null,8,["modelValue"])])),_:1}),(0,d.Wm)(v,{label:"发送类型",prop:"type"},{default:(0,d.w5)((()=>[(0,d.Wm)(H,{modelValue:e.form.type,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.type=t)},{default:(0,d.w5)((()=>[(0,d.Wm)(j,{label:1},{default:(0,d.w5)((()=>[p])),_:1}),(0,d.Wm)(j,{label:2},{default:(0,d.w5)((()=>[b])),_:1})])),_:1},8,["modelValue"])])),_:1}),1===e.form.type?((0,d.wg)(),(0,d.j4)(v,{key:0,label:"收件人",prop:"email"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{modelValue:e.form.email,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.email=t),placeholder:"收件人",maxlength:"50","show-word-limit":""},null,8,["modelValue"])])),_:1})):(0,d.kq)("",!0),2===e.form.type?((0,d.wg)(),(0,d.j4)(v,{key:1,label:"收件人",prop:"emails"},{default:(0,d.w5)((()=>[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(e.form.emails,(t=>((0,d.wg)(),(0,d.j4)(C,{class:"margin_r-10 margin_b-10",key:t,closable:"","disable-transitions":!1,onClose:l=>e.closeHandle(t)},{default:(0,d.w5)((()=>[(0,d.Uk)((0,f.zw)(t),1)])),_:2},1032,["onClose"])))),128)),e.inputVisible?((0,d.wg)(),(0,d.j4)(y,{key:0,ref:"refInput",modelValue:e.inputValue,"onUpdate:modelValue":t[4]||(t[4]=t=>e.inputValue=t),onKeyup:(0,c.D2)(e.confirmHandle,["enter"])},null,8,["modelValue","onKeyup"])):((0,d.wg)(),(0,d.j4)(W,{key:1,class:"margin_b-10",size:"small",onClick:e.addHandle},{default:(0,d.w5)((()=>[(0,d.Wm)(U,{name:"plus"})])),_:1},8,["onClick"]))])),_:1})):(0,d.kq)("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue","onClosed"])}l(21703),l(26699);var _=l(84367),h=l(68257),y=l(37530),v=l(91450),Z=(0,d.aZ)({emits:["refresh"],components:{Quill:s.Z},setup(e,{emit:t}){const l=(0,_.iH)(),n=(0,_.iH)(),a=(0,_.iH)(),u=(0,_.qj)({visible:!1,inputVisible:!1,inputValue:"",form:{subject:"",content:"",type:1,email:"",emails:[]}}),r=(0,_.qj)(function(){const e=(e,t,l)=>{""!==t&&(0,y.Jh)(t)?l():l(new Error("请输入正确的邮箱地址"))};return{subject:[{required:!0,message:"请输入邮件标题",trigger:"blur"}],content:[{required:!0,message:"请输入邮件内容",trigger:"blur"}],email:[{required:!0,validator:e,trigger:"blur"}],emails:[{type:"array",required:!0,message:"请至少输入一个邮箱地址",trigger:"blur"}]}}()),o=()=>{u.visible=!0},i=()=>{u.inputVisible=!0,(0,d.Y3)((e=>{a.value.$refs.input.focus()}))},s=()=>{let e="请输入正确的邮箱!";if((0,y.Jh)(u.inputValue)){if(!u.form.emails.includes(u.inputValue))return u.form.emails.push(u.inputValue),u.inputValue="",void(u.inputVisible=!1);e="该邮箱已存在!"}(0,h.z8)({message:e,type:"warning"}),a.value.$refs.input.focus()},m=e=>{u.form.emails.splice(u.form.emails.indexOf(e),1)},f=()=>{l.value.validate((async e=>{if(e){const e={subject:u.form.subject,content:n.value.getEncodeHtml(),type:u.form.type,emails:1===u.form.type?[u.form.email]:u.form.emails,enclosures:[]},l=await(0,v.ou)(e);l&&(u.visible=!1,(0,h.z8)({message:"操作成功!",type:"success"}),t("refresh"))}}))},c=()=>{l.value.resetFields()};return{refForm:l,refQuill:n,refInput:a,...(0,_.BK)(u),rules:r,init:o,closeHandle:m,addHandle:i,confirmHandle:s,submit:f,dialogClosedHandle:c}}}),j=l(40465);const H=(0,j.Z)(Z,[["render",V]]);var C=H}}]);