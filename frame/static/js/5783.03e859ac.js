"use strict";(self["webpackChunkvue3_element_plus_admin"]=self["webpackChunkvue3_element_plus_admin"]||[]).push([[5783],{78362:function(e,r,t){t.d(r,{D4:function(){return a},Iw:function(){return d},K4:function(){return o},Lo:function(){return b},PI:function(){return p},Sx:function(){return h},Uj:function(){return m},X$:function(){return g},b2:function(){return f},c3:function(){return c},ef:function(){return i},mg:function(){return s},ou:function(){return l},wS:function(){return u}});var n=t(20077);function a(e){return(0,n.Z)({url:"/backstage/role/page",method:"get",params:e})}function o(e){return(0,n.Z)({url:`/backstage/role/info/${e}`,method:"get"})}function l(e){return(0,n.Z)({url:"/backstage/role/create",method:"post",data:e})}function u(e){return(0,n.Z)({url:"/backstage/role/update",method:"post",data:e})}function i(e){return(0,n.Z)({url:"/backstage/role/delete",method:"post",data:e})}function s(e){return(0,n.Z)({url:"/backstage/role/show",method:"post",data:e})}function d(){return(0,n.Z)({url:"/backstage/role/select/list",method:"get"})}function m(e){return(0,n.Z)({url:"/backstage/role/global/page",method:"get",params:e})}function c(e){return(0,n.Z)({url:`/backstage/role/global/info/${e}`,method:"get"})}function f(e){return(0,n.Z)({url:"/backstage/role/global/create",method:"post",data:e})}function p(e){return(0,n.Z)({url:"/backstage/role/global/update",method:"post",data:e})}function g(e){return(0,n.Z)({url:"/backstage/role/global/delete",method:"post",data:e})}function b(e){return(0,n.Z)({url:"/backstage/role/global/show",method:"post",data:e})}function h(e){return(0,n.Z)({url:`/backstage/role/global/select/list/${e}`,method:"get"})}},80134:function(e,r,t){t.r(r),t.d(r,{default:function(){return Z}});var n=t(42321),a=(t(1926),t(14646)),o=(t(21123),t(13289)),l=(t(14635),t(59571)),u=(t(97085),t(33612)),i=(t(82262),t(58125),t(66847)),s=(t(28630),t(440)),d=t(54592);const m={class:"dialog-footer"},c=(0,s.Uk)("取消"),f=(0,s.Uk)("确认");function p(e,r,t,p,g,b){const h=i.EZ,_=l.nH,w=u.m,k=l.ly,v=o.mi,Z=a.d0,y=n.t,V=(0,s.Q2)("repeat");return(0,s.wg)(),(0,s.j4)(Z,{width:"450px",title:e.form.id?"编辑":"新增",modelValue:e.visible,"onUpdate:modelValue":r[6]||(r[6]=r=>e.visible=r),"close-on-click-modal":!1,onClosed:e.dialogClosedHandle,"append-to-body":"",draggable:""},{footer:(0,s.w5)((()=>[(0,s._)("span",m,[(0,s.Wm)(v,{onClick:r[4]||(r[4]=r=>e.visible=!1)},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.wy)(((0,s.wg)(),(0,s.j4)(v,{type:"primary",onClick:r[5]||(r[5]=r=>e.submit())},{default:(0,s.w5)((()=>[f])),_:1})),[[V]])])])),default:(0,s.w5)((()=>[(0,s.wy)(((0,s.wg)(),(0,s.j4)(k,{model:e.form,rules:e.rules,ref:"refForm",onKeyup:r[3]||(r[3]=(0,d.D2)((r=>e.submit()),["enter"])),"label-position":"top"},{default:(0,s.w5)((()=>[(0,s.Wm)(_,{label:"角色名称",prop:"name"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.form.name,"onUpdate:modelValue":r[0]||(r[0]=r=>e.form.name=r),placeholder:"角色名称",maxlength:"20","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(_,{label:"备注",prop:"remark"},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{modelValue:e.form.remark,"onUpdate:modelValue":r[1]||(r[1]=r=>e.form.remark=r),type:"textarea",placeholder:"备注",maxlength:"100","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,s.Wm)(_,{label:"权限",prop:"enterprise_menu_ids"},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{class:"width-full",ref:"refCascader",modelValue:e.form.enterprise_menu_ids,"onUpdate:modelValue":r[2]||(r[2]=r=>e.form.enterprise_menu_ids=r),options:e.menus,props:e.cascaderProps,"show-all-levels":!1,"collapse-tags":"","collapse-tags-tooltip":"",clearable:""},null,8,["modelValue","options","props"])])),_:1})])),_:1},8,["model","rules"])),[[y,e.loading]])])),_:1},8,["title","modelValue","onClosed"])}var g=t(84367),b=t(68257),h=t(58712),_=t(78362),w=(0,s.aZ)({emits:["refresh"],setup(e,{emit:r}){const t=(0,g.iH)(),n=(0,g.iH)(),a=(0,g.qj)({loading:!1,visible:!1,form:{id:null,name:"",remark:"",enterprise_menu_ids:[],enterprise_id:""},menus:[]}),o=(0,g.qj)(function(){return{name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],enterprise_menu_ids:[{type:"array",required:!0,message:"请选择权限",trigger:"blur"}]}}()),l=(0,s.Fl)((()=>{const e={multiple:!0,emitPath:!1,checkStrictly:!1,value:"id",label:"name_cn",children:"children"};return e})),u=async()=>{const e=await(0,h.Sx)(a.form.enterprise_id);if(e){const r=[{id:0,name_cn:"一级菜单",name_en:"First level menu",parent_id:0,children:e.data}];a.menus=r}},i=async(e,r)=>{if(a.visible=!0,a.loading=!0,a.form.enterprise_id=e,a.form.id=r,await u(),r){const e=await(0,_.c3)(r);e&&(a.form.name=e.data.name,a.form.remark=e.data.remark,a.form.enterprise_menu_ids=e.data.enterprise_menu_ids)}(0,s.Y3)((()=>{a.loading=!1}))},d=()=>{t.value.validate((async e=>{if(e){const e=n.value.getCheckedNodes(!0),t=[];e.forEach((e=>{t.push.apply(t,e.pathValues)})),a.form.enterprise_menu_ids=Array.from(new Set(t)).filter((e=>0!==e));const o=a.form.id?await(0,_.PI)(a.form):await(0,_.b2)(a.form);o&&(a.visible=!1,(0,b.z8)({message:"操作成功!",type:"success"}),r("refresh"))}}))},m=()=>{t.value.resetFields()};return{refForm:t,refCascader:n,...(0,g.BK)(a),rules:o,cascaderProps:l,init:i,submit:d,dialogClosedHandle:m}}}),k=t(40465);const v=(0,k.Z)(w,[["render",p]]);var Z=v},15691:function(e,r,t){t.d(r,{Z:function(){return p}});var n=t(33392),a=t(7163),o=t(85963),l=t(54421),u=a.Z?a.Z.isConcatSpreadable:void 0;function i(e){return(0,l.Z)(e)||(0,o.Z)(e)||!!(u&&e&&e[u])}var s=i;function d(e,r,t,a,o){var l=-1,u=e.length;t||(t=s),o||(o=[]);while(++l<u){var i=e[l];r>0&&t(i)?r>1?d(i,r-1,t,a,o):(0,n.Z)(o,i):a||(o[o.length]=i)}return o}var m=d,c=1/0;function f(e){var r=null==e?0:e.length;return r?m(e,c):[]}var p=f}}]);